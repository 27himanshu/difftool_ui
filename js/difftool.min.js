define(["vs/editor/editor.main"],t=>{const e=["javascript","json","html","typescript"],o="txt",i={setupMonacoTab:function(e){if(this._setup)return;let o=localStorage.getItem("dtOriginalText");null==o&&(o="just some text\n\nHello World\n\nSome more text");let i=localStorage.getItem("dtModifiedText");null==i&&(i="just some Text\n\nHello World\n\nSome more changes");const d=t.editor.createModel(o,"text/plain"),n=t.editor.createModel(i,"text/plain");this.diffEditor=t.editor.createDiffEditor(e,{originalEditable:!0,readOnly:!1,theme:"vs-dark"}),this.diffEditor.setModel({original:d,modified:n});const a=(t,e)=>{let o=null;return(...i)=>{window.clearTimeout(o),o=window.setTimeout(()=>{t(...i)},e)}},r=a(()=>{this.diffEditor.layout()},100);this.setupTabBar(),window.addEventListener("resize",r),this.setupSessionPersistence(),this._setup=!0},setupSessionPersistence:function(){window.addEventListener("visibilitychange",t=>{const e=this.diffEditor.getModel().original.getValue();localStorage.setItem("dtOriginalText",e);const o=this.diffEditor.getModel().modified.getValue();localStorage.setItem("dtModifiedText",o);const i=document.getElementById("dt-difftool-language-type-selector");localStorage.setItem("dtLanguageType",i.value);const d=document.getElementById("dt-difftool-wordwrap-checkbox");localStorage.setItem("dtWordWrap",d.checked)})},setupTabBar:function(){const t=document.getElementById("dt-difftool-language-type-selector");let e=localStorage.getItem("dtLanguageType");null==e&&(e=o),t.value=e,this.updateLanguage(e),t.addEventListener("change",t=>{this.updateLanguage(t.target.value)});const i=document.querySelector("button.dt-difftool-autoformat-button");i.addEventListener("click",t=>{this.autoformat()});const d=document.getElementById("dt-difftool-wordwrap-checkbox"),n="true"===localStorage.getItem("dtWordWrap");n&&this.updateWordWrap(!0);const a=document.querySelector("button.dt-difftool-wordwrap-button");a.addEventListener("click",t=>{let e=!d.checked;this.updateWordWrap(e)}),d.addEventListener("change",t=>{let e=!d.checked;this.updateWordWrap(e),a.focus()});const r=document.querySelector(".dt-difftool-sidebyside-button");let l=localStorage.getItem("dtSideBySide");l=null==l?!(navigator.userAgent.indexOf("Mobi")>-1):"false"!==l,this.sideBySideVlaue=l,this.updateSideBySide(this.sideBySideVlaue),r.addEventListener("click",t=>{this.toggleSideBySide()});const s=document.querySelector("button.dt-difftool-download-button");s.addEventListener("click",t=>{this.downloadFiles()})},downloadFiles:function(){const t=this.diffEditor.getModel().original.getValue(),e=this.diffEditor.getModel().modified.getValue(),o=new Blob([t],{type:"text/plain"}),i=document.createElement("a");let d=(new Date).toLocaleString([],{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0});d=d.replace(/, /,"-"),d=d.replace(/ /,"_");const n=`Difftool_Original_${d}.txt`;i.href=URL.createObjectURL(o),i.download=n,i.click(),URL.revokeObjectURL(i.href);const a=new Blob([e],{type:"text/plain"}),r=document.createElement("a"),l=`Difftool_Modified_${d}.txt`;r.href=URL.createObjectURL(a),r.download=l,r.click(),URL.revokeObjectURL(r.href)},toggleSideBySide:function(){this.sideBySideVlaue=!this.sideBySideVlaue,this.updateSideBySide(this.sideBySideVlaue)},updateSideBySide:function(t){const e=t?"Side By Side":"Inline",o=document.querySelector(".dt-difftool-sidebyside-button");o.textContent=e,this.diffEditor.updateOptions({renderSideBySide:t}),localStorage.setItem("dtSideBySide",t)},updateWordWrap:function(t){const e=document.getElementById("dt-difftool-wordwrap-checkbox");e.checked=t,this.diffEditor.updateOptions({wordWrap:t?"on":"off"})},updateLanguage:async function(o){await t.editor.setModelLanguage(this.diffEditor.getModel().modified,o),await t.editor.setModelLanguage(this.diffEditor.getModel().original,o),e.indexOf(o)<0?this.hideTabBarButton(".dt-difftool-autoformat-button"):this.showTabBarButton(".dt-difftool-autoformat-button")},hideTabBarButton:function(t){const e=document.querySelector(t);e.parentNode.classList.add("dt-hidden")},showTabBarButton:function(t){const e=document.querySelector(t);e.parentNode.classList.remove("dt-hidden")},autoformat:function(){this.diffEditor.getOriginalEditor().getAction("editor.action.formatDocument").run(),this.diffEditor.getModifiedEditor().getAction("editor.action.formatDocument").run()},resize:function(){this._setup&&this.diffEditor.layout()},updateTheme:function(t){this._setup&&this.diffEditor.updateOptions({theme:`vs-${t}`})}};return i});