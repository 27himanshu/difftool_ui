define(["vs/editor/editor.main"],t=>{const e={setupMonacoTab:function(e){let o=localStorage.getItem("dtOriginalText");o||(o="just some text\n\nHello World\n\nSome more text");let i=localStorage.getItem("dtModifiedText");i||(i="just some Text\n\nHello World\n\nSome more changes");const d=t.editor.createModel(o,"text/plain"),a=t.editor.createModel(i,"text/plain");this.diffEditor=t.editor.createDiffEditor(e,{originalEditable:!0,readOnly:!1,theme:"vs-dark"}),this.diffEditor.setModel({original:d,modified:a});const n=(t,e)=>{let o=null;return(...i)=>{window.clearTimeout(o),o=window.setTimeout(()=>{t(...i)},e)}},r=n(()=>{this.diffEditor.layout()},100);this.setupTabBar(),window.addEventListener("resize",r),this.setupSessionPersistence()},setupSessionPersistence:function(){window.addEventListener("visibilitychange",t=>{const e=this.diffEditor.getModel().original.getValue();localStorage.setItem("dtOriginalText",e);const o=this.diffEditor.getModel().modified.getValue();localStorage.setItem("dtModifiedText",o);const i=document.getElementById("dt-difftool-language-type-selector");localStorage.setItem("dtLanguageType",i.value);const d=document.getElementById("dt-difftool-wordwrap-checkbox");localStorage.setItem("dtWordWrap",d.checked)})},setupTabBar:function(){const t=document.getElementById("dt-difftool-language-type-selector"),e=localStorage.getItem("dtLanguageType");e&&(t.value=e,this.updateLanguage(e)),t.addEventListener("change",t=>{this.updateLanguage(t.target.value)});const o=document.querySelector("button.dt-difftool-autoformat-button");o.addEventListener("click",t=>{this.autoformat()});const i=document.getElementById("dt-difftool-wordwrap-checkbox"),d="true"===localStorage.getItem("dtWordWrap");d&&(i.checked=!0,this.updateWordWrap(!0)),i.addEventListener("change",t=>{this.updateWordWrap(t.target.checked)})},updateWordWrap:function(t){this.diffEditor.updateOptions({wordWrap:t?"on":"off"})},updateLanguage:async function(e){await t.editor.setModelLanguage(this.diffEditor.getModel().modified,e),await t.editor.setModelLanguage(this.diffEditor.getModel().original,e)},autoformat:function(){setTimeout(()=>{this.diffEditor.getOriginalEditor().getAction("editor.action.formatDocument").run(),this.diffEditor.getModifiedEditor().getAction("editor.action.formatDocument").run()},100)},resize:function(){this.diffEditor.layout()},updateTheme:function(t){this.diffEditor.updateOptions({theme:`vs-${t}`})}};return e});