define(["vs/editor/editor.main"],e=>{const t={setupMonacoTab:function(t){let i=localStorage.getItem("dtOriginalText");i||(i="just some text\n\nHello World\n\nSome more text");let d=localStorage.getItem("dtModifiedText");d||(d="just some Text\n\nHello World\n\nSome more changes");const o=e.editor.createModel(i,"text/plain"),a=e.editor.createModel(d,"text/plain");this.diffEditor=e.editor.createDiffEditor(t,{originalEditable:!0,readOnly:!1,theme:"vs-dark"}),this.diffEditor.setModel({original:o,modified:a});const n=(e,t)=>{let i=null;return(...d)=>{window.clearTimeout(i),i=window.setTimeout(()=>{e(...d)},t)}},r=n(()=>{this.diffEditor.layout()},100);this.setupTabBar(),window.addEventListener("resize",r),this.setupSessionPersistence()},setupSessionPersistence:function(){window.addEventListener("visibilitychange",e=>{const t=this.diffEditor.getModel().original.getValue();localStorage.setItem("dtOriginalText",t);const i=this.diffEditor.getModel().modified.getValue();localStorage.setItem("dtModifiedText",i);const d=document.getElementById("dt-difftool-language-type-selector");localStorage.setItem("dtLanguageType",d.value);const o=document.getElementById("dt-difftool-wordwrap-checkbox");localStorage.setItem("dtWordWrap",o.checked)})},setupTabBar:function(){const e=document.getElementById("dt-difftool-language-type-selector"),t=localStorage.getItem("dtLanguageType");t&&(e.value=t,this.updateLanguage(t)),e.addEventListener("change",e=>{this.updateLanguage(e.target.value)});const i=document.querySelector("button.dt-difftool-autoformat-button");i.addEventListener("click",e=>{this.autoformat()});const d=document.getElementById("dt-difftool-wordwrap-checkbox"),o="true"===localStorage.getItem("dtWordWrap");o&&(d.checked=!0,this.updateWordWrap(!0)),d.addEventListener("change",e=>{this.updateWordWrap(e.target.checked)});const a=document.querySelector(".dt-difftool-sidebyside-button");this.sideBySideVlaue=!("false"===localStorage.getItem("dtSideBySide")),this.updateSideBySide(this.sideBySideVlaue),a.addEventListener("click",e=>{this.toggleSideBySide()})},toggleSideBySide:function(){this.sideBySideVlaue=!this.sideBySideVlaue,this.updateSideBySide(this.sideBySideVlaue)},updateSideBySide:function(e){this.diffEditor.updateOptions({renderSideBySide:e}),localStorage.setItem("dtSideBySide",e)},updateWordWrap:function(e){this.diffEditor.updateOptions({wordWrap:e?"on":"off"})},updateLanguage:async function(t){await e.editor.setModelLanguage(this.diffEditor.getModel().modified,t),await e.editor.setModelLanguage(this.diffEditor.getModel().original,t)},autoformat:function(){this.diffEditor.getOriginalEditor().getAction("editor.action.formatDocument").run(),this.diffEditor.getModifiedEditor().getAction("editor.action.formatDocument").run()},resize:function(){this.diffEditor.layout()},updateTheme:function(e){this.diffEditor.updateOptions({theme:`vs-${e}`})}};return t});