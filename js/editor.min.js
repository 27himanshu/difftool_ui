define(["vs/editor/editor.main"],t=>{const e=["javascript","json","html","typescript"],o="txt",n={setupMonacoTab:function(e){if(this._setup)return;let o=localStorage.getItem("eText");null==o&&(o="just some text\n\nHello World\n\nSome more text");const n=t.editor.createModel(o,"text/plain");this.editor=t.editor.create(e,{theme:"vs-dark",minimap:{enabled:!1}}),this.editor.setModel(n);const d=(t,e)=>{let o=null;return(...n)=>{window.clearTimeout(o),o=window.setTimeout(()=>{t(...n)},e)}},r=d(()=>{this.editor.layout()},100);this.setupTabBar(),window.addEventListener("resize",r),this.setupSessionPersistence(),this._setup=!0},setupSessionPersistence:function(){window.addEventListener("visibilitychange",t=>{const e=this.editor.getModel().getValue();localStorage.setItem("eText",e);const o=document.getElementById("dt-editor-language-type-selector");localStorage.setItem("eLanguageType",o.value);const n=document.getElementById("dt-editor-wordwrap-checkbox");localStorage.setItem("eWordWrap",n.checked)})},setupTabBar:function(){const t=document.getElementById("dt-editor-language-type-selector");let e=localStorage.getItem("eLanguageType");null==e&&(e=o),t.value=e,this.updateLanguage(e),t.addEventListener("change",t=>{this.updateLanguage(t.target.value)});const n=document.querySelector("button.dt-editor-autoformat-button");n.addEventListener("click",t=>{this.autoformat()});const d=document.querySelector("button.dt-editor-download-button");d.addEventListener("click",t=>{this.downloadFile()});const r=document.getElementById("dt-editor-wordwrap-checkbox"),a="true"===localStorage.getItem("eWordWrap");a&&this.updateWordWrap(!0);const i=document.querySelector("button.dt-editor-wordwrap-button");i.addEventListener("click",t=>{let e=!r.checked;this.updateWordWrap(e)}),r.addEventListener("change",t=>{let e=!r.checked;this.updateWordWrap(e),i.focus()})},downloadFile:function(){const t=this.editor.getModel().getValue(),e=new Blob([t],{type:"text/plain"}),o=document.createElement("a");let n=(new Date).toLocaleString([],{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0});n=n.replace(/, /,"-"),n=n.replace(/ /,"_");const d=`Difftool_Editor_${n}.txt`;o.href=URL.createObjectURL(e),o.download=d,o.click(),URL.revokeObjectURL(o.href)},updateWordWrap:function(t){const e=document.getElementById("dt-editor-wordwrap-checkbox");e.checked=t,this.editor.updateOptions({wordWrap:t?"on":"off"})},updateLanguage:async function(o){await t.editor.setModelLanguage(this.editor.getModel(),o),e.indexOf(o)<0?this.hideTabBarButton(".dt-editor-autoformat-button"):this.showTabBarButton(".dt-editor-autoformat-button")},hideTabBarButton:function(t){const e=document.querySelector(t);e.parentNode.classList.add("dt-hidden")},showTabBarButton:function(t){const e=document.querySelector(t);e.parentNode.classList.remove("dt-hidden")},autoformat:function(){this.editor.getAction("editor.action.formatDocument").run()},resize:function(){this._setup&&this.editor.layout()},updateTheme:function(t){this._setup&&this.editor.updateOptions({theme:`vs-${t}`})}};return n});