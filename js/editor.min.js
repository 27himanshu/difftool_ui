define(["vs/editor/editor.main"],t=>{const e=["javascript","json","html","typescript"],o={setupMonacoTab:function(e){if(this._setup)return;let o=localStorage.getItem("eText");null==o&&(o="just some text\n\nHello World\n\nSome more text");const n=t.editor.createModel(o,"text/plain");this.editor=t.editor.create(e,{theme:"vs-dark",minimap:{enabled:!1}}),this.editor.setModel(n);const a=(t,e)=>{let o=null;return(...n)=>{window.clearTimeout(o),o=window.setTimeout(()=>{t(...n)},e)}},d=a(()=>{this.editor.layout()},100);this.setupTabBar(),window.addEventListener("resize",d),this.setupSessionPersistence(),this._setup=!0},setupSessionPersistence:function(){window.addEventListener("visibilitychange",t=>{const e=this.editor.getModel().getValue();localStorage.setItem("eText",e);const o=document.getElementById("dt-editor-language-type-selector");localStorage.setItem("eLanguageType",o.value);const n=document.getElementById("dt-editor-wordwrap-checkbox");localStorage.setItem("eWordWrap",n.checked)})},setupTabBar:function(){const t=document.getElementById("dt-editor-language-type-selector"),e=localStorage.getItem("eLanguageType");e&&(t.value=e,this.updateLanguage(e)),t.addEventListener("change",t=>{this.updateLanguage(t.target.value)});const o=document.querySelector("button.dt-editor-autoformat-button");o.addEventListener("click",t=>{this.autoformat()});const n=document.getElementById("dt-editor-wordwrap-checkbox"),a="true"===localStorage.getItem("eWordWrap");a&&(n.checked=!0,this.updateWordWrap(!0)),n.addEventListener("change",t=>{this.updateWordWrap(t.target.checked)})},updateWordWrap:function(t){this.editor.updateOptions({wordWrap:t?"on":"off"})},updateLanguage:async function(o){await t.editor.setModelLanguage(this.editor.getModel(),o),e.indexOf(o)<0?this.hideTabBarButton(".dt-editor-autoformat-button"):this.showTabBarButton(".dt-editor-autoformat-button")},hideTabBarButton:function(t){const e=document.querySelector(t);e.parentNode.classList.add("dt-hidden")},showTabBarButton:function(t){const e=document.querySelector(t);e.parentNode.classList.remove("dt-hidden")},autoformat:function(){this.editor.getAction("editor.action.formatDocument").run()},resize:function(){this._setup&&this.editor.layout()},updateTheme:function(t){this._setup&&this.editor.updateOptions({theme:`vs-${t}`})}};return o});